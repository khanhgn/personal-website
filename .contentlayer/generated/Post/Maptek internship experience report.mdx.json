{
  "title": "How to do Parallel Training",
  "date": "2024-05-30T00:00:00.000Z",
  "description": "a reflection about my internship at Maptek",
  "body": {
    "raw": "\n# Introduction\nÂ This report aims to display my work in the internship at Maptek over this semester. To briefly outline the team that I worked with, I collaborated with Maptek's DomainMCF team which focuses on using machine learning to produce 3D geological models specifically domain and grades models. My job in this was to make everything run faster. Maptek has the requirement of faster training time and inference for their neural networks which will dramatically boost the customer experience as well as other downstream tasks.\nGoing into this project, I did not know much other than the fact that I must somehow look through this code base and understand how to make it run faster. The original neural network has been ported from tensorflow to FLAX/JAX recently which already shows a speed increase. However, I would need to make the new FLAX/JAX implementation run even faster.\n\n# Here are the results\n![[image.png]]\n\nThe red bar represents the original Tensorflow implementation of the DomainMCF neural network. As demonstrated by the graph, it is quite slow at nearly 1000 seconds to run train a 10 million parameter model over 190 epochs with a batch size of 16384. The green bar shows the FLAX/JAX model, the same neural network programmed on a different deep learning framework which is much better in terms of speed compares to previous frameworks such as PyTorch or Tensorflow. Lets shift our attention towards the parallel models now. In yellow is the Tensorflow model implemented with mirrored strategy - a prebuilt function provided by the Tensorflow library that allows synchronous training across multiple replicas. As expected, it is faster than both the Tensorflow and FLAX on 1 gpu. But what about parallel training on JAX/FLAX. Well, blue and black are my implementations, a near 50% speed up compared to where we started.\n# So how did I do it.\n### Let's start with the basics - What is JAX/FLAX\nJAX is a machine learning framework that was created by the researchers at Google Deepmind for transforming numerical functions. While FLAX is the accompanying neural network library that is designed with object oriented design in mind. So what does this all mean? JAX runs really really fast. But what is the tradeoff? JAX is pretty hard to approach - particularly for a new comer, not only for its difficult for the functional programming paradigm, the learning curve is steep due to concepts such as JIT (just in time compilation), VMAP (vectorising maps) and shard_map. It also does not help that the JAX documentation is written for someone with some experience in mind. Nevertheless, the first few days of the project involved me sitting down for many hours trying to implement neural networks from scratch using this framework for the first time. \n\n### What were my strategies going in to this\nPrior to conducting any work on the large code base given to me from Maptek, I had to plan out carefully which improvements i could make to the code. Here are the few things that I can come up with:\n1. The model currently only works on 1 accelerator, what if we need to deploy it on the cloud where there are any number of accelerators?\n2. The loss function is not implemented with vectorising maps (VMAP), will reimplementing it result in a speed up?\n3. How can the GPUs usage vary to maximise performance?\n4. The batch size currently is fixed, this does not maximise GPU usage, how can we find a better batch size? will finding the max batch size result in a speed up?\n5. Let's make sure the inference pipeline is parallelised as well.\n\n### 1. Training across multiple accelerators\nAfter reviewing the training loop, I realised that the 2 components that could be parallelised are the loss function and the gradient computation.\n#### Implementation of Loss Parallelism:\n\nWhen implementing parallel training, I explored various methods:\n\n- **Data Parallelism:** Divides training data across multiple processors, with each processor working on its subset independently. Gradients are aggregated and averaged for model parameter updates, ideal for large datasets.\n  \n- **Model Parallelism:** Distributes different model parts across processors, each handling a segment and computing forward/backward passes. Suitable for very large models exceeding single processor memory limits.\n  \n- **Pipeline Parallelism:** Combines data and model parallelism, segmenting the model and assigning segments to processors. Data flows sequentially through these segments, balancing computation and memory usage.\n\nI chose Data Parallelism due to its suitability because unless the model significantly surpasses single GPU capacity, it will not make sense to go for the other techniques. Initially, model parameters are replicated across accelerators. The batch is evenly divided among accelerators for loss computation. The averaged loss is then used for calculating gradients across the model and subsequent updates.\n\nHere is the sample code of a non parallel loss function (not actual code from the project):\n\n```python\nimport jax\nimport jax.numpy as jnp\n@jax.jit\ndef loss_fn(params, batch):\n\tinputs, targets = batch\n\tpredictions = predict(params, inputs)\n\treturn jnp.mean(jnp.sum((predictions - targets)**2, axis=-1))\n```\n\nHere is the sample code of how we can make it parallel (not actual code from the project):\n\n```python\nfrom functools import partial\nfrom jax.sharding import NamedSharding, Mesh, PartitionSpec as P\nfrom jax.experimental.shard_map import shard_map\nfrom jax.experimental import mesh_utils\n\n@jax.jit\ndef loss_dp(params, batch):\n\tdevices = mes_utils.create_device_mesh(2,)\n\tm = Mesh(devices, ('batch',))\n\t@partial(shard_map, mesh=mesh, in_specs=P('batch', None), out_specs=P())\n\tdef loss_spmd(params, batch):\n\t\tbatch_local_loss = loss_fn(params, batch)\n\t\treturn jax.lax.pmean(batch_local_loss, 'batch')\n\treturn loss_spmd(params, batch)\n```\n\nOptional:\n- These 2 lines are used to explicitly load the accelerators, however, my testing shows that this results in worse performance when compared to JAX's own dynamic memory allocation method\n```python\nparams = jax.device_put(params, NamedSharding(mesh, P()))\ninputs = jax.device_put(batch, NamedSharding(mesh, P('batch')))\n```\n\nHere is a demo of precisely what the method is doing for a batch size of 8 over 2 GPUs:\n\n**The batch is divided evenly over 2 GPUs so each gpu should return 4 loss values:**\n- On cuda:0 at mesh coordinates (batch,) = (0,):\n    ```python\n    [[1.2023029 ]\n     [0.71759206]\n     [0.29744676]\n     [0.80767024]]\n    ```\n\n- On cuda:1 at mesh coordinates (batch,) = (1,):\n    ```python\n    [[0.7249529 ]\n     [1.2052361 ]\n     [0.80882186]\n     [0.7385298 ]]\n    ```\n\n **On each gpu the loss values calculated is average to get the local loss:**\n- On cuda:0 at mesh coordinates (batch,) = (0,):\n    ```python\n    0.7562530040740967\n    ```\n\n- On cuda:1 at mesh coordinates (batch,) = (1,):\n    ```python\n    0.8693851232528687\n    ```\n\n **`pmean` is performed over 2 gpus to get the average loss for that batch of 8:**\n- On cuda:0 at mesh coordinates (batch,) = (0,):\n    ```python\n    0.8128190636634827\n    ```\n\n- On cuda:1 at mesh coordinates (batch,) = (1,):\n    ```python\n    0.8128190636634827\n    ```\n\n**Final Loss returned by function:**\n```python\n0.81281906\n```\n\n#### Implementation of Gradients Parallelism:\n\nFor enhanced efficiency, I parallelised gradients calculation. Before gathering and averaging loss, gradients are independently computed on each GPU. Finally, the average gradients are used for the final update.\n\nHere is the sample code (not from Maptek's codebase):\n\n```python\nfrom functools import partial\nfrom jax.sharding import NamedSharding, Mesh, PartitionSpec as P\nfrom jax.experimental.shard_map import shard_map\nfrom jax.experimental import mesh_utils\nimport jax\nimport jax.numpy as jnp\n\n@jax.jit\ndef loss_fn(params, batch):\n\tinputs, targets = batch\n\tpredictions = predict(params, inputs)\n\treturn jnp.mean(jnp.sum((predictions - targets)**2, axis=-1))\n\n@jax.jit\ndef get_loss_gradients(params, batch):\n\tdevices = mes_utils.create_device_mesh(2,)\n\tm = Mesh(devices, ('batch',))\n\t@partial(shard_map, mesh=mesh, in_specs=P('batch', None), out_specs=P())\n\tdef parallel_loss_and_gradients(params, batch):\n\t\tloss_local, grads_local = jax.value_and_grad(loss_fn)(params,batch)\n\t\tloss = jax.lax.pmean(loss_local, 'batch')\n\t\tgrads = jax.lax.pmean(grads_local, 'batch')\n\t\treturn loss, grads\n\treturn parallel_loss_and_gradients(params, batch)\n```\n\nNotice that the `value_and_grad` function is nested inside of a `shard_map`. This means that no explicit sharding of the `loss_fn` function is required.\n```python\n@partial(shard_map, mesh=mesh, in_specs=P('batch', None), out_specs=P())\n\tdef parallel_loss_and_gradients(params, batch):\n\t\tloss_local, grads_local = jax.value_and_grad(loss_fn)(params,batch)\n\t\tloss = jax.lax.pmean(loss_local, 'batch')\n\t\tgrads = jax.lax.pmean(grads_local, 'batch')\n\t\treturn loss, grads\n\treturn parallel_loss_and_gradients(params, batch)```\n\nHere is a demo of what this method is doing to a 81 parameter network.\n\n**Data Labels:**\n- `data_labels`: (2, 64)\n- `data_inputs`: (128, 2)\n\n**Sharded (what each GPU gets):**\n- `data_labels`: (64,)\n- `data_inputs`: (64, 2)\n\n**Before pmean:**\n```python\n{\n    'params': {\n        'Dense_0': {\n            'bias': {\n                'On cuda:0 at mesh coordinates (batch,) = (0,)': [0.00814706, 0.06351265, 0.13132916, ...],\n                'On cuda:1 at mesh coordinates (batch,) = (1,)': [0.00723927, 0.05536034, 0.11896412, ...]\n            },\n            'kernel': {\n                'On cuda:0 at mesh coordinates (batch,) = (0,)': [[3.15032015e-03, 2.28520837e-02, ...], [...]],\n                'On cuda:1 at mesh coordinates (batch,) = (1,)': [[3.8428977e-03, 2.7929787e-02, ...], [...]]\n            }\n        },\n        'Dense_1': {\n            'bias': {\n                'On cuda:0 at mesh coordinates (batch,) = (0,)': [0.358499],\n                'On cuda:1 at mesh coordinates (batch,) = (1,)': [0.33250016]\n            },\n            'kernel': {\n                'On cuda:0 at mesh coordinates (batch,) = (0,)': [[-8.91311318e-02], [-1.09796718e-01], ...],\n                'On cuda:1 at mesh coordinates (batch,) = (1,)': [[-0.10461892], [-0.12866098], ...]\n            }\n        }\n    }\n}\n```\n\n**After pmean:**\n```python\n{\n    'params': {\n        'Dense_0': {\n            'bias': {\n                'On cuda:0 at mesh coordinates (batch,) = (0,)': [0.00769317, 0.05943649, 0.12514664, ...],\n                'On cuda:1 at mesh coordinates (batch,) = (1,)': [0.00769317, 0.05943649, 0.12514664, ...]\n            },\n            'kernel': {\n                'On cuda:0 at mesh coordinates (batch,) = (0,)': [[3.4966089e-03, 2.5390934e-02, ...], [...]],\n                'On cuda:1 at mesh coordinates (batch,) = (1,)': [[3.4966089e-03, 2.5390934e-02, ...], [...]]\n            }\n        },\n        'Dense_1': {\n            'bias': {\n                'On cuda:0 at mesh coordinates (batch,) = (0,)': [0.34549958],\n                'On cuda:1 at mesh coordinates (batch,) = (1,)': [0.34549958]\n            },\n            'kernel': {\n                'On cuda:0 at mesh coordinates (batch,) = (0,)': [[-0.09687503], [-0.11922885], ...],\n                'On cuda:1 at mesh coordinates (batch,) = (1,)': [[-0.09687503], [-0.11922885], ...]\n            }\n        }\n    }\n}\n```\n\n\n### 2. Implementation of Vectorising Maps:\n\nEfforts were made to re-implement the loss function using vectorising maps to boost speed. However, no significant improvement was observed compared to native batched operations. VMAPs also consumed more memory in certain cases, leading to a shift back to native operations.\n### 3. Implementation of Dynamic GPU Utilisation:\n\nConsidering varying GPU architectures and quantities, I implemented functions to dynamically allocate data. This is crucial, especially for the last training step when the final batch size might differ from the predetermined size. This serves two cases: sending the last bit of data to a single GPU if it fits, or performing a search for the optimal number of GPUs for computation if it doesn't.\n\nJAX's high controllability comes with the cost of having to implement a lot of the things that Tensorflow automate manually. For example, if we have 4 accelerators and the last batch is odd, this will cause the entire program to fail. The way that we could combat this is to have a check function implemented where we dynamically find the optimal number of accelerators that would fit the current batch size. This is simply implemented using for loops, if statements and also using the modulo operator to determine if the batch would work with a certain amount of accelerators. \n\n### 4. Implementation of batch_size Initialisation:\n\nThe idea behind this segment is that speed should increase as the batch size that is being handled by each GPU is increased. Because of this, I have derived a function to dynamically calculate the maximum batch size that each GPU can handle. factors considered include GPU architecture, model and optimizer sizes, and data shape. This ensures maximum performance across different models and machines.\n#### Note: Making the Losses of the Flax Model Coherent\n\nTo ensure consistent comparisons, every randomized aspect of the Flax model is assigned a coherent seed. However, attempts to make TensorFlow model loss coherent by seeding the data generator did not yield consistent results. This indicates internal TensorFlow parameters not being consistently initialized, resulting in varying loss compared to Flax models. As a result of this, while the speed up produced by my work is backed up by the graph produced, further work is needed to investigate the state of the Tensorflow model.",
    "code": "var Component=(()=>{var on=Object.create;var j=Object.defineProperty;var mn=Object.getOwnPropertyDescriptor;var bn=Object.getOwnPropertyNames;var un=Object.getPrototypeOf,pn=Object.prototype.hasOwnProperty;var Y=(m,e)=>()=>(e||m((e={exports:{}}).exports,e),e.exports),hn=(m,e)=>{for(var f in e)j(m,f,{get:e[f],enumerable:!0})},ge=(m,e,f,y)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let x of bn(e))!pn.call(m,x)&&x!==f&&j(m,x,{get:()=>e[x],enumerable:!(y=mn(e,x))||y.enumerable});return m};var cn=(m,e,f)=>(f=m!=null?on(un(m)):{},ge(e||!m||!m.__esModule?j(f,\"default\",{value:m,enumerable:!0}):f,m)),fn=m=>ge(j({},\"__esModule\",{value:!0}),m);var De=Y((vn,ve)=>{ve.exports=React});var we=Y($=>{\"use strict\";(function(){\"use strict\";var m=De(),e=Symbol.for(\"react.element\"),f=Symbol.for(\"react.portal\"),y=Symbol.for(\"react.fragment\"),x=Symbol.for(\"react.strict_mode\"),H=Symbol.for(\"react.profiler\"),J=Symbol.for(\"react.provider\"),q=Symbol.for(\"react.context\"),U=Symbol.for(\"react.forward_ref\"),S=Symbol.for(\"react.suspense\"),R=Symbol.for(\"react.suspense_list\"),F=Symbol.for(\"react.memo\"),O=Symbol.for(\"react.lazy\"),Fe=Symbol.for(\"react.offscreen\"),K=Symbol.iterator,Ae=\"@@iterator\";function Ce(s){if(s===null||typeof s!=\"object\")return null;var l=K&&s[K]||s[Ae];return typeof l==\"function\"?l:null}var v=m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function p(s){{for(var l=arguments.length,d=new Array(l>1?l-1:0),r=1;r<l;r++)d[r-1]=arguments[r];Ee(\"error\",s,d)}}function Ee(s,l,d){{var r=v.ReactDebugCurrentFrame,i=r.getStackAddendum();i!==\"\"&&(l+=\"%s\",d=d.concat([i]));var o=d.map(function(t){return String(t)});o.unshift(\"Warning: \"+l),Function.prototype.apply.call(console[s],console,o)}}var Te=!1,Pe=!1,je=!1,Se=!1,Re=!1,Z;Z=Symbol.for(\"react.module.reference\");function Oe(s){return!!(typeof s==\"string\"||typeof s==\"function\"||s===y||s===H||Re||s===x||s===S||s===R||Se||s===Fe||Te||Pe||je||typeof s==\"object\"&&s!==null&&(s.$$typeof===O||s.$$typeof===F||s.$$typeof===J||s.$$typeof===q||s.$$typeof===U||s.$$typeof===Z||s.getModuleId!==void 0))}function Ie(s,l,d){var r=s.displayName;if(r)return r;var i=l.displayName||l.name||\"\";return i!==\"\"?d+\"(\"+i+\")\":d}function Q(s){return s.displayName||\"Context\"}function _(s){if(s==null)return null;if(typeof s.tag==\"number\"&&p(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof s==\"function\")return s.displayName||s.name||null;if(typeof s==\"string\")return s;switch(s){case y:return\"Fragment\";case f:return\"Portal\";case H:return\"Profiler\";case x:return\"StrictMode\";case S:return\"Suspense\";case R:return\"SuspenseList\"}if(typeof s==\"object\")switch(s.$$typeof){case q:var l=s;return Q(l)+\".Consumer\";case J:var d=s;return Q(d._context)+\".Provider\";case U:return Ie(s,s.render,\"ForwardRef\");case F:var r=s.displayName||null;return r!==null?r:_(s.type)||\"Memo\";case O:{var i=s,o=i._payload,t=i._init;try{return _(t(o))}catch{return null}}}return null}var g=Object.assign,B=0,ee,ne,se,le,de,re,ae;function te(){}te.__reactDisabledLog=!0;function Me(){{if(B===0){ee=console.log,ne=console.info,se=console.warn,le=console.error,de=console.group,re=console.groupCollapsed,ae=console.groupEnd;var s={configurable:!0,enumerable:!0,value:te,writable:!0};Object.defineProperties(console,{info:s,log:s,warn:s,error:s,group:s,groupCollapsed:s,groupEnd:s})}B++}}function Le(){{if(B--,B===0){var s={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:g({},s,{value:ee}),info:g({},s,{value:ne}),warn:g({},s,{value:se}),error:g({},s,{value:le}),group:g({},s,{value:de}),groupCollapsed:g({},s,{value:re}),groupEnd:g({},s,{value:ae})})}B<0&&p(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var I=v.ReactCurrentDispatcher,M;function A(s,l,d){{if(M===void 0)try{throw Error()}catch(i){var r=i.stack.trim().match(/\\n( *(at )?)/);M=r&&r[1]||\"\"}return`\n`+M+s}}var L=!1,C;{var We=typeof WeakMap==\"function\"?WeakMap:Map;C=new We}function ie(s,l){if(!s||L)return\"\";{var d=C.get(s);if(d!==void 0)return d}var r;L=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var o;o=I.current,I.current=null,Me();try{if(l){var t=function(){throw Error()};if(Object.defineProperty(t.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(t,[])}catch(N){r=N}Reflect.construct(s,[],t)}else{try{t.call()}catch(N){r=N}s.call(t.prototype)}}else{try{throw Error()}catch(N){r=N}s()}}catch(N){if(N&&r&&typeof N.stack==\"string\"){for(var a=N.stack.split(`\n`),h=r.stack.split(`\n`),b=a.length-1,u=h.length-1;b>=1&&u>=0&&a[b]!==h[u];)u--;for(;b>=1&&u>=0;b--,u--)if(a[b]!==h[u]){if(b!==1||u!==1)do if(b--,u--,u<0||a[b]!==h[u]){var c=`\n`+a[b].replace(\" at new \",\" at \");return s.displayName&&c.includes(\"<anonymous>\")&&(c=c.replace(\"<anonymous>\",s.displayName)),typeof s==\"function\"&&C.set(s,c),c}while(b>=1&&u>=0);break}}}finally{L=!1,I.current=o,Le(),Error.prepareStackTrace=i}var w=s?s.displayName||s.name:\"\",ye=w?A(w):\"\";return typeof s==\"function\"&&C.set(s,ye),ye}function Ge(s,l,d){return ie(s,!1)}function Ve(s){var l=s.prototype;return!!(l&&l.isReactComponent)}function E(s,l,d){if(s==null)return\"\";if(typeof s==\"function\")return ie(s,Ve(s));if(typeof s==\"string\")return A(s);switch(s){case S:return A(\"Suspense\");case R:return A(\"SuspenseList\")}if(typeof s==\"object\")switch(s.$$typeof){case U:return Ge(s.render);case F:return E(s.type,l,d);case O:{var r=s,i=r._payload,o=r._init;try{return E(o(i),l,d)}catch{}}}return\"\"}var T=Object.prototype.hasOwnProperty,oe={},me=v.ReactDebugCurrentFrame;function P(s){if(s){var l=s._owner,d=E(s.type,s._source,l?l.type:null);me.setExtraStackFrame(d)}else me.setExtraStackFrame(null)}function Xe(s,l,d,r,i){{var o=Function.call.bind(T);for(var t in s)if(o(s,t)){var a=void 0;try{if(typeof s[t]!=\"function\"){var h=Error((r||\"React class\")+\": \"+d+\" type `\"+t+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof s[t]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw h.name=\"Invariant Violation\",h}a=s[t](l,t,r,d,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(b){a=b}a&&!(a instanceof Error)&&(P(i),p(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",r||\"React class\",d,t,typeof a),P(null)),a instanceof Error&&!(a.message in oe)&&(oe[a.message]=!0,P(i),p(\"Failed %s type: %s\",d,a.message),P(null))}}}var ze=Array.isArray;function W(s){return ze(s)}function Ye(s){{var l=typeof Symbol==\"function\"&&Symbol.toStringTag,d=l&&s[Symbol.toStringTag]||s.constructor.name||\"Object\";return d}}function $e(s){try{return be(s),!1}catch{return!0}}function be(s){return\"\"+s}function ue(s){if($e(s))return p(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",Ye(s)),be(s)}var k=v.ReactCurrentOwner,He={key:!0,ref:!0,__self:!0,__source:!0},pe,he,G;G={};function Je(s){if(T.call(s,\"ref\")){var l=Object.getOwnPropertyDescriptor(s,\"ref\").get;if(l&&l.isReactWarning)return!1}return s.ref!==void 0}function qe(s){if(T.call(s,\"key\")){var l=Object.getOwnPropertyDescriptor(s,\"key\").get;if(l&&l.isReactWarning)return!1}return s.key!==void 0}function Ke(s,l){if(typeof s.ref==\"string\"&&k.current&&l&&k.current.stateNode!==l){var d=_(k.current.type);G[d]||(p('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',_(k.current.type),s.ref),G[d]=!0)}}function Ze(s,l){{var d=function(){pe||(pe=!0,p(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",l))};d.isReactWarning=!0,Object.defineProperty(s,\"key\",{get:d,configurable:!0})}}function Qe(s,l){{var d=function(){he||(he=!0,p(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",l))};d.isReactWarning=!0,Object.defineProperty(s,\"ref\",{get:d,configurable:!0})}}var en=function(s,l,d,r,i,o,t){var a={$$typeof:e,type:s,key:l,ref:d,props:t,_owner:o};return a._store={},Object.defineProperty(a._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(a,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:r}),Object.defineProperty(a,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:i}),Object.freeze&&(Object.freeze(a.props),Object.freeze(a)),a};function nn(s,l,d,r,i){{var o,t={},a=null,h=null;d!==void 0&&(ue(d),a=\"\"+d),qe(l)&&(ue(l.key),a=\"\"+l.key),Je(l)&&(h=l.ref,Ke(l,i));for(o in l)T.call(l,o)&&!He.hasOwnProperty(o)&&(t[o]=l[o]);if(s&&s.defaultProps){var b=s.defaultProps;for(o in b)t[o]===void 0&&(t[o]=b[o])}if(a||h){var u=typeof s==\"function\"?s.displayName||s.name||\"Unknown\":s;a&&Ze(t,u),h&&Qe(t,u)}return en(s,a,h,i,r,k.current,t)}}var V=v.ReactCurrentOwner,ce=v.ReactDebugCurrentFrame;function D(s){if(s){var l=s._owner,d=E(s.type,s._source,l?l.type:null);ce.setExtraStackFrame(d)}else ce.setExtraStackFrame(null)}var X;X=!1;function z(s){return typeof s==\"object\"&&s!==null&&s.$$typeof===e}function fe(){{if(V.current){var s=_(V.current.type);if(s)return`\n\nCheck the render method of \\``+s+\"`.\"}return\"\"}}function sn(s){{if(s!==void 0){var l=s.fileName.replace(/^.*[\\\\\\/]/,\"\"),d=s.lineNumber;return`\n\nCheck your code at `+l+\":\"+d+\".\"}return\"\"}}var _e={};function ln(s){{var l=fe();if(!l){var d=typeof s==\"string\"?s:s.displayName||s.name;d&&(l=`\n\nCheck the top-level render call using <`+d+\">.\")}return l}}function Ne(s,l){{if(!s._store||s._store.validated||s.key!=null)return;s._store.validated=!0;var d=ln(l);if(_e[d])return;_e[d]=!0;var r=\"\";s&&s._owner&&s._owner!==V.current&&(r=\" It was passed a child from \"+_(s._owner.type)+\".\"),D(s),p('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',d,r),D(null)}}function xe(s,l){{if(typeof s!=\"object\")return;if(W(s))for(var d=0;d<s.length;d++){var r=s[d];z(r)&&Ne(r,l)}else if(z(s))s._store&&(s._store.validated=!0);else if(s){var i=Ce(s);if(typeof i==\"function\"&&i!==s.entries)for(var o=i.call(s),t;!(t=o.next()).done;)z(t.value)&&Ne(t.value,l)}}}function dn(s){{var l=s.type;if(l==null||typeof l==\"string\")return;var d;if(typeof l==\"function\")d=l.propTypes;else if(typeof l==\"object\"&&(l.$$typeof===U||l.$$typeof===F))d=l.propTypes;else return;if(d){var r=_(l);Xe(d,s.props,\"prop\",r,s)}else if(l.PropTypes!==void 0&&!X){X=!0;var i=_(l);p(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",i||\"Unknown\")}typeof l.getDefaultProps==\"function\"&&!l.getDefaultProps.isReactClassApproved&&p(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function rn(s){{for(var l=Object.keys(s.props),d=0;d<l.length;d++){var r=l[d];if(r!==\"children\"&&r!==\"key\"){D(s),p(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",r),D(null);break}}s.ref!==null&&(D(s),p(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),D(null))}}function an(s,l,d,r,i,o){{var t=Oe(s);if(!t){var a=\"\";(s===void 0||typeof s==\"object\"&&s!==null&&Object.keys(s).length===0)&&(a+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var h=sn(i);h?a+=h:a+=fe();var b;s===null?b=\"null\":W(s)?b=\"array\":s!==void 0&&s.$$typeof===e?(b=\"<\"+(_(s.type)||\"Unknown\")+\" />\",a=\" Did you accidentally export a JSX literal instead of a component?\"):b=typeof s,p(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",b,a)}var u=nn(s,l,d,i,o);if(u==null)return u;if(t){var c=l.children;if(c!==void 0)if(r)if(W(c)){for(var w=0;w<c.length;w++)xe(c[w],s);Object.freeze&&Object.freeze(c)}else p(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else xe(c,s)}return s===y?rn(u):dn(u),u}}var tn=an;$.Fragment=y,$.jsxDEV=tn})()});var ke=Y((wn,Be)=>{\"use strict\";Be.exports=we()});var yn={};hn(yn,{default:()=>xn,frontmatter:()=>_n});var n=cn(ke()),_n={title:\"How to do Parallel Training\",description:\"a reflection about my internship at Maptek\",date:new Date(17170272e5)};function Ue(m){let e=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",p:\"p\",h3:\"h3\",ol:\"ol\",li:\"li\",h4:\"h4\",ul:\"ul\",strong:\"strong\",div:\"div\",pre:\"pre\",code:\"code\"},m.components);return(0,n.jsxDEV)(n.Fragment,{children:[(0,n.jsxDEV)(e.h1,{id:\"introduction\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#introduction\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"Introduction\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:`\\xA0This report aims to display my work in the internship at Maptek over this semester. To briefly outline the team that I worked with, I collaborated with Maptek's DomainMCF team which focuses on using machine learning to produce 3D geological models specifically domain and grades models. My job in this was to make everything run faster. Maptek has the requirement of faster training time and inference for their neural networks which will dramatically boost the customer experience as well as other downstream tasks.\nGoing into this project, I did not know much other than the fact that I must somehow look through this code base and understand how to make it run faster. The original neural network has been ported from tensorflow to FLAX/JAX recently which already shows a speed increase. However, I would need to make the new FLAX/JAX implementation run even faster.`},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h1,{id:\"here-are-the-results\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#here-are-the-results\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"Here are the results\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"![[image.png]]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"The red bar represents the original Tensorflow implementation of the DomainMCF neural network. As demonstrated by the graph, it is quite slow at nearly 1000 seconds to run train a 10 million parameter model over 190 epochs with a batch size of 16384. The green bar shows the FLAX/JAX model, the same neural network programmed on a different deep learning framework which is much better in terms of speed compares to previous frameworks such as PyTorch or Tensorflow. Lets shift our attention towards the parallel models now. In yellow is the Tensorflow model implemented with mirrored strategy - a prebuilt function provided by the Tensorflow library that allows synchronous training across multiple replicas. As expected, it is faster than both the Tensorflow and FLAX on 1 gpu. But what about parallel training on JAX/FLAX. Well, blue and black are my implementations, a near 50% speed up compared to where we started.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h1,{id:\"so-how-did-i-do-it\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#so-how-did-i-do-it\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"So how did I do it.\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h3,{id:\"lets-start-with-the-basics---what-is-jaxflax\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#lets-start-with-the-basics---what-is-jaxflax\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"Let's start with the basics - What is JAX/FLAX\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"JAX is a machine learning framework that was created by the researchers at Google Deepmind for transforming numerical functions. While FLAX is the accompanying neural network library that is designed with object oriented design in mind. So what does this all mean? JAX runs really really fast. But what is the tradeoff? JAX is pretty hard to approach - particularly for a new comer, not only for its difficult for the functional programming paradigm, the learning curve is steep due to concepts such as JIT (just in time compilation), VMAP (vectorising maps) and shard_map. It also does not help that the JAX documentation is written for someone with some experience in mind. Nevertheless, the first few days of the project involved me sitting down for many hours trying to implement neural networks from scratch using this framework for the first time.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h3,{id:\"what-were-my-strategies-going-in-to-this\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#what-were-my-strategies-going-in-to-this\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"What were my strategies going in to this\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"Prior to conducting any work on the large code base given to me from Maptek, I had to plan out carefully which improvements i could make to the code. Here are the few things that I can come up with:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.ol,{children:[`\n`,(0,n.jsxDEV)(e.li,{children:\"The model currently only works on 1 accelerator, what if we need to deploy it on the cloud where there are any number of accelerators?\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.li,{children:\"The loss function is not implemented with vectorising maps (VMAP), will reimplementing it result in a speed up?\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.li,{children:\"How can the GPUs usage vary to maximise performance?\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.li,{children:\"The batch size currently is fixed, this does not maximise GPU usage, how can we find a better batch size? will finding the max batch size result in a speed up?\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.li,{children:\"Let's make sure the inference pipeline is parallelised as well.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h3,{id:\"1-training-across-multiple-accelerators\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#1-training-across-multiple-accelerators\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"1. Training across multiple accelerators\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:27,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"After reviewing the training loop, I realised that the 2 components that could be parallelised are the loss function and the gradient computation.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:28,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h4,{id:\"implementation-of-loss-parallelism\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#implementation-of-loss-parallelism\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"Implementation of Loss Parallelism:\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"When implementing parallel training, I explored various methods:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:31,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.ul,{children:[`\n`,(0,n.jsxDEV)(e.li,{children:[`\n`,(0,n.jsxDEV)(e.p,{children:[(0,n.jsxDEV)(e.strong,{children:\"Data Parallelism:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:33,columnNumber:3},this),\" Divides training data across multiple processors, with each processor working on its subset independently. Gradients are aggregated and averaged for model parameter updates, ideal for large datasets.\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:33,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:33,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.li,{children:[`\n`,(0,n.jsxDEV)(e.p,{children:[(0,n.jsxDEV)(e.strong,{children:\"Model Parallelism:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:35,columnNumber:3},this),\" Distributes different model parts across processors, each handling a segment and computing forward/backward passes. Suitable for very large models exceeding single processor memory limits.\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:35,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:35,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.li,{children:[`\n`,(0,n.jsxDEV)(e.p,{children:[(0,n.jsxDEV)(e.strong,{children:\"Pipeline Parallelism:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:37,columnNumber:3},this),\" Combines data and model parallelism, segmenting the model and assigning segments to processors. Data flows sequentially through these segments, balancing computation and memory usage.\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:37,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:37,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:33,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"I chose Data Parallelism due to its suitability because unless the model significantly surpasses single GPU capacity, it will not make sense to go for the other techniques. Initially, model parameters are replicated across accelerators. The batch is evenly divided among accelerators for loss computation. The averaged loss is then used for calculating gradients across the model and subsequent updates.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"Here is the sample code of a non parallel loss function (not actual code from the project):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:41,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:147},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.numpy \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:62},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"as\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:109},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jnp\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:147},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"@jax\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"jit\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:97},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"def\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:59},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"loss_fn\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:96},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:139},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"params\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:176},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:238},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"batch\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:276},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:337},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\tinputs, targets \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:73},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" batch\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:110},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\tpredictions \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:69},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:106},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"predict\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:143},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(params, inputs)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:186},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"return\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jnp.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:99},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"mean\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:140},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(jnp.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:180},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"sum\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:221},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"((predictions \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:260},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:310},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" targets)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:347},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"**\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:392},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:430},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:467},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"axis\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:505},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:565},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"1\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:603},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:640},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:43,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"Here is the sample code of how we can make it parallel (not actual code from the project):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:53,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"from\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" functools \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:145},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:192},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" partial\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:234},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"from\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.sharding \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:110},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" NamedSharding, Mesh, PartitionSpec \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:152},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"as\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:224},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:262},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"from\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.experimental.shard_map \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:124},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" shard_map\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:166},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"from\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.experimental \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:114},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" mesh_utils\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:156},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"@jax\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"jit\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:97},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"def\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:59},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"loss_dp\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:96},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:139},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"params\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:176},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:238},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"batch\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:276},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:337},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\tdevices \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:65},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" mes_utils.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:102},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"create_device_mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:149},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:240},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:277},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\tm \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:59},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:96},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"Mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:133},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(devices, (\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:173},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:220},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",))\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:271},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"\t@partial\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:65},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"shard_map\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:102},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:147},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:184},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:221},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:281},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:318},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:358},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:395},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"in_specs\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:432},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:496},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:533},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:570},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:607},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:658},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:695},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"None\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:732},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"),\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:772},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:810},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"out_specs\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:847},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:912},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:949},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"())\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:986},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"def\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:96},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"loss_spmd\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:133},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:178},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"params\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:215},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:277},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"batch\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:315},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:376},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\tbatch_local_loss \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:75},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:112},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"loss_fn\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:149},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(params, batch)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:192},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"return\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.lax.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:100},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"pmean\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:145},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(batch_local_loss, \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:186},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:241},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\")\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:292},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"return\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:99},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"loss_spmd\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:136},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(params, batch)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:181},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:55,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"Optional:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:72,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.ul,{children:[`\n`,(0,n.jsxDEV)(e.li,{children:\"These 2 lines are used to explicitly load the accelerators, however, my testing shows that this results in worse performance when compared to JAX's own dynamic memory allocation method\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:73,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:73,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"params \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:148},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:185},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"device_put\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:226},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(params, \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:272},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"NamedSharding\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:317},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(mesh, \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:366},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:409},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"()))\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:446},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"inputs \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:63},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:100},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"device_put\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:141},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(batch, \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:187},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"NamedSharding\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:231},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(mesh, \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:280},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:323},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:360},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:397},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\")))\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:448},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:74,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"Here is a demo of precisely what the method is doing for a batch size of 8 over 2 GPUs:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:79,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:(0,n.jsxDEV)(e.strong,{children:\"The batch is divided evenly over 2 GPUs so each gpu should return 4 loss values:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:81,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:81,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.ul,{children:[`\n`,(0,n.jsxDEV)(e.li,{children:[`\n`,(0,n.jsxDEV)(e.p,{children:\"On cuda:0 at mesh coordinates (batch,) = (0,):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:82,columnNumber:3},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"[[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"1.2023029\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:143},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" ]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:188},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.71759206\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:104},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.29744676\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:104},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.80767024\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:104},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:83,columnNumber:5},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:82,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.li,{children:[`\n`,(0,n.jsxDEV)(e.p,{children:\"On cuda:1 at mesh coordinates (batch,) = (1,):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:90,columnNumber:3},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"[[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.7249529\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:143},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" ]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:188},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"1.2052361\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" ]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:103},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.80882186\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:104},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.7385298\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" ]]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:103},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:91,columnNumber:5},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:90,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:82,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:(0,n.jsxDEV)(e.strong,{children:\"On each gpu the loss values calculated is average to get the local loss:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:98,columnNumber:2},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:98,columnNumber:2},this),`\n`,(0,n.jsxDEV)(e.ul,{children:[`\n`,(0,n.jsxDEV)(e.li,{children:[`\n`,(0,n.jsxDEV)(e.p,{children:\"On cuda:0 at mesh coordinates (batch,) = (0,):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:99,columnNumber:3},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.7562530040740967\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:100,columnNumber:5},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:99,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.li,{children:[`\n`,(0,n.jsxDEV)(e.p,{children:\"On cuda:1 at mesh coordinates (batch,) = (1,):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:104,columnNumber:3},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.8693851232528687\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:105,columnNumber:5},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:104,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:99,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:(0,n.jsxDEV)(e.strong,{children:[(0,n.jsxDEV)(e.code,{children:\"pmean\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:109,columnNumber:4},this),\" is performed over 2 gpus to get the average loss for that batch of 8:\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:109,columnNumber:2},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:109,columnNumber:2},this),`\n`,(0,n.jsxDEV)(e.ul,{children:[`\n`,(0,n.jsxDEV)(e.li,{children:[`\n`,(0,n.jsxDEV)(e.p,{children:\"On cuda:0 at mesh coordinates (batch,) = (0,):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:110,columnNumber:3},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.8128190636634827\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:111,columnNumber:5},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:110,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.li,{children:[`\n`,(0,n.jsxDEV)(e.p,{children:\"On cuda:1 at mesh coordinates (batch,) = (1,):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:115,columnNumber:3},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.8128190636634827\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:116,columnNumber:5},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:115,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:110,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:(0,n.jsxDEV)(e.strong,{children:\"Final Loss returned by function:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:120,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:120,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.81281906\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:121,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h4,{id:\"implementation-of-gradients-parallelism\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#implementation-of-gradients-parallelism\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"Implementation of Gradients Parallelism:\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:125,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"For enhanced efficiency, I parallelised gradients calculation. Before gathering and averaging loss, gradients are independently computed on each GPU. Finally, the average gradients are used for the final update.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:127,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"Here is the sample code (not from Maptek's codebase):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:129,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"from\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" functools \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:145},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:192},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" partial\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:234},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"from\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.sharding \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:110},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" NamedSharding, Mesh, PartitionSpec \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:152},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"as\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:224},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:262},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"from\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.experimental.shard_map \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:124},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" shard_map\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:166},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"from\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.experimental \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:114},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" mesh_utils\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:156},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:62},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"import\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.numpy \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:62},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"as\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:109},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jnp\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:147},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"@jax\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"jit\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:97},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"def\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:59},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"loss_fn\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:96},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:139},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"params\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:176},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:238},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"batch\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:276},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:337},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\tinputs, targets \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:73},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" batch\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:110},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\tpredictions \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:69},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:106},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"predict\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:143},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(params, inputs)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:186},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"return\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jnp.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:99},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"mean\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:140},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(jnp.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:180},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"sum\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:221},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"((predictions \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:260},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:310},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" targets)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:347},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"**\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:392},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:430},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:467},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"axis\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:505},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:565},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"1\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:603},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"))\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:640},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"@jax\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\".\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"jit\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:97},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"def\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:59},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"get_loss_gradients\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:96},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:150},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"params\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:187},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:249},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"batch\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:287},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:348},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\tdevices \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:65},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" mes_utils.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:102},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"create_device_mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:149},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:240},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:277},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\tm \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:59},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:96},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"Mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:133},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(devices, (\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:173},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:220},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",))\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:271},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"\t@partial\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:65},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"shard_map\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:102},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:147},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:184},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:221},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:281},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:318},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:358},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:395},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"in_specs\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:432},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:496},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:533},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:570},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:607},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:658},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:695},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"None\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:732},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"),\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:772},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:810},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"out_specs\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:847},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:912},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:949},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"())\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:986},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"def\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:96},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"parallel_loss_and_gradients\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:133},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:196},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"params\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:233},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:295},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"batch\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:333},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:394},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\tloss_local, grads_local \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:82},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:119},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"value_and_grad\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:160},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(loss_fn)(params,batch)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:210},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\tloss \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:63},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.lax.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:100},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"pmean\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:145},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(loss_local, \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:186},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:235},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\")\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:286},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\tgrads \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:64},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.lax.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:101},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"pmean\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:146},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(grads_local, \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:187},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:237},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\")\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:288},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"return\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" loss, grads\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:100},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"return\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:99},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"parallel_loss_and_gradients\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:136},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(params, batch)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:199},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:131,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:[\"Notice that the \",(0,n.jsxDEV)(e.code,{children:\"value_and_grad\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:158,columnNumber:17},this),\" function is nested inside of a \",(0,n.jsxDEV)(e.code,{children:\"shard_map\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:158,columnNumber:65},this),\". This means that no explicit sharding of the \",(0,n.jsxDEV)(e.code,{children:\"loss_fn\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:158,columnNumber:122},this),\" function is required.\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:158,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"@partial\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:149},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"shard_map\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:186},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:231},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:268},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:305},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:365},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"mesh\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:402},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:442},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:479},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"in_specs\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:516},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:580},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:617},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:654},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:691},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:742},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:779},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"None\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:816},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"),\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:856},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:894},this),(0,n.jsxDEV)(e.span,{style:{color:\"#E06C75\",fontStyle:\"italic\"},children:\"out_specs\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:931},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:996},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"P\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1033},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"())\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1070},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"def\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:96},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"parallel_loss_and_gradients\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:133},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:196},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"params\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:233},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:295},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\",fontStyle:\"italic\"},children:\"batch\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:333},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:394},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\tloss_local, grads_local \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:82},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:119},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"value_and_grad\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:160},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(loss_fn)(params,batch)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:210},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\tloss \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:63},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.lax.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:100},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"pmean\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:145},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(loss_local, \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:186},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:235},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\")\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:286},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\tgrads \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"=\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:64},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" jax.lax.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:101},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"pmean\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:146},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(grads_local, \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:187},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'batch'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:237},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\")\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:288},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"return\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" loss, grads\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:100},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"\t\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"return\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:99},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"parallel_loss_and_gradients\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:136},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"(params, batch)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:199},this),(0,n.jsxDEV)(e.span,{style:{color:\"#FFFFFF\"},children:\"```\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:250},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"Here \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"is\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:61},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" a demo of what this method \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:99},this),(0,n.jsxDEV)(e.span,{style:{color:\"#C678DD\"},children:\"is\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" doing to a \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:201},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"81\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:249},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" parameter network.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:287},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"**\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"Data Labels:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"**\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:106},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#FFFFFF\"},children:\"`data_labels`\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:94},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": (\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:143},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:182},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:219},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"64\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:257},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\")\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:295},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#FFFFFF\"},children:\"`data_inputs`\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:94},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": (\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:143},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"128\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:182},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:221},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:259},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\")\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:296},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"**\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#61AFEF\"},children:\"Sharded\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" (what each \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:101},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"GPU\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:149},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" gets):\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:188},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"**\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:231},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#FFFFFF\"},children:\"`data_labels`\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:94},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": (\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:143},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"64\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:182},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\",)\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:220},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:57},this),(0,n.jsxDEV)(e.span,{style:{color:\"#FFFFFF\"},children:\"`data_inputs`\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:94},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": (\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:143},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"64\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:182},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:220},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:258},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\")\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:295},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:\" \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"**\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"Before pmean:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:58},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"**\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:107},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#FFFFFF\"},children:\"```python\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"{\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"    \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'params'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:112},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"        \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'Dense_0'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:64},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:117},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'bias'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:68},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:118},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:0 at mesh coordinates (batch,) = (0,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.00814706\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:202},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:248},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.06351265\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:286},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:332},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.13132916\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:370},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:416},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:454},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"],\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:493},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:25,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:1 at mesh coordinates (batch,) = (1,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.00723927\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:202},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:248},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.05536034\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:286},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:332},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.11896412\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:370},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:416},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:454},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:493},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:26,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            },\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:27,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:27,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:28,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'kernel'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:28,columnNumber:68},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:28,columnNumber:120},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:28,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:0 at mesh coordinates (batch,) = (0,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"3.15032015e-03\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:253},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2.28520837e-02\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:291},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:341},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:379},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:418},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:458},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]],\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:497},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:29,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:1 at mesh coordinates (batch,) = (1,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"3.8428977e-03\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:252},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2.7929787e-02\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:290},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:339},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:377},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:416},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:456},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:495},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:30,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            }\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:31,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:31,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"        },\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:32,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:32,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"        \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:33,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'Dense_1'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:33,columnNumber:64},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:33,columnNumber:117},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:33,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:34,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'bias'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:34,columnNumber:68},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:34,columnNumber:118},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:34,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:35,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:0 at mesh coordinates (batch,) = (0,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:35,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:35,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.358499\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:35,columnNumber:202},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"],\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:35,columnNumber:246},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:35,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:36,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:1 at mesh coordinates (batch,) = (1,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:36,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:36,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.33250016\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:36,columnNumber:202},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:36,columnNumber:248},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:36,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            },\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:37,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:37,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:38,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'kernel'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:38,columnNumber:68},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:38,columnNumber:120},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:38,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:0 at mesh coordinates (batch,) = (0,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"8.91311318e-02\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:240},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:290},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:330},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"1.09796718e-01\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:367},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:417},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:456},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"],\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:495},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:39,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:1 at mesh coordinates (batch,) = (1,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.10461892\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:240},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:286},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:326},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.12866098\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:363},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:409},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:448},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:487},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:40,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            }\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:41,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:41,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"        }\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:42,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:42,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"    }\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:43,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:43,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"}\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:44,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:44,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:159,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:(0,n.jsxDEV)(e.strong,{children:\"After pmean:\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:206,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:206,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsxDEV)(e.pre,{style:{backgroundColor:\"#282c34\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"default\",children:(0,n.jsxDEV)(e.code,{\"data-language\":\"python\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"{\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:105},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:86},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"    \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'params'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:60},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:112},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"        \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'Dense_0'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:64},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:117},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:3,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'bias'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:68},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:118},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:4,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:0 at mesh coordinates (batch,) = (0,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.00769317\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:202},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:248},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.05943649\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:286},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:332},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.12514664\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:370},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:416},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:454},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"],\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:493},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:5,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:1 at mesh coordinates (batch,) = (1,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.00769317\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:202},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:248},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.05943649\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:286},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:332},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.12514664\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:370},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:416},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:454},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:493},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:6,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            },\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:7,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'kernel'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:68},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:120},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:8,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:0 at mesh coordinates (batch,) = (0,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"3.4966089e-03\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:252},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2.5390934e-02\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:290},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:339},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:377},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:416},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:456},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]],\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:495},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:1 at mesh coordinates (batch,) = (1,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"3.4966089e-03\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:252},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"2.5390934e-02\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:290},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\", \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:339},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:377},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:416},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:456},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:495},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:10,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            }\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"        },\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:12,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"        \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'Dense_1'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:64},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:117},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'bias'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:68},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:118},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:14,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:0 at mesh coordinates (batch,) = (0,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.34549958\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:202},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"],\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:248},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:1 at mesh coordinates (batch,) = (1,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.34549958\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:202},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:248},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:16,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            },\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'kernel'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:68},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": {\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:120},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:18,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:0 at mesh coordinates (batch,) = (0,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.09687503\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:240},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:286},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:326},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.11922885\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:363},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:409},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:448},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"],\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:487},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"                \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:20},this),(0,n.jsxDEV)(e.span,{style:{color:\"#98C379\"},children:\"'On cuda:1 at mesh coordinates (batch,) = (1,)'\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:72},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\": [[\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:163},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:203},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.09687503\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:240},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], [\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:286},this),(0,n.jsxDEV)(e.span,{style:{color:\"#56B6C2\"},children:\"-\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:326},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"0.11922885\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:363},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"], \"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:409},this),(0,n.jsxDEV)(e.span,{style:{color:\"#D19A66\"},children:\"...\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:448},this),(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"]\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:487},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:20,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"            }\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"        }\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:22,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"    }\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:23,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,n.jsxDEV)(e.span,{style:{color:\"#ABB2BF\"},children:\"}\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:24,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:80},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:207,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h3,{id:\"2-implementation-of-vectorising-maps\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#2-implementation-of-vectorising-maps\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"2. Implementation of Vectorising Maps:\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:235,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"Efforts were made to re-implement the loss function using vectorising maps to boost speed. However, no significant improvement was observed compared to native batched operations. VMAPs also consumed more memory in certain cases, leading to a shift back to native operations.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:237,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h3,{id:\"3-implementation-of-dynamic-gpu-utilisation\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#3-implementation-of-dynamic-gpu-utilisation\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"3. Implementation of Dynamic GPU Utilisation:\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:238,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"Considering varying GPU architectures and quantities, I implemented functions to dynamically allocate data. This is crucial, especially for the last training step when the final batch size might differ from the predetermined size. This serves two cases: sending the last bit of data to a single GPU if it fits, or performing a search for the optimal number of GPUs for computation if it doesn't.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:240,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"JAX's high controllability comes with the cost of having to implement a lot of the things that Tensorflow automate manually. For example, if we have 4 accelerators and the last batch is odd, this will cause the entire program to fail. The way that we could combat this is to have a check function implemented where we dynamically find the optimal number of accelerators that would fit the current batch size. This is simply implemented using for loops, if statements and also using the modulo operator to determine if the batch would work with a certain amount of accelerators.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:242,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h3,{id:\"4-implementation-of-batch_size-initialisation\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#4-implementation-of-batch_size-initialisation\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"4. Implementation of batch_size Initialisation:\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:244,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"The idea behind this segment is that speed should increase as the batch size that is being handled by each GPU is increased. Because of this, I have derived a function to dynamically calculate the maximum batch size that each GPU can handle. factors considered include GPU architecture, model and optimizer sizes, and data shape. This ensures maximum performance across different models and machines.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:246,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.h4,{id:\"note-making-the-losses-of-the-flax-model-coherent\",children:[(0,n.jsxDEV)(e.a,{className:\"anchor\",href:\"#note-making-the-losses-of-the-flax-model-coherent\",children:(0,n.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this),\"Note: Making the Losses of the Flax Model Coherent\"]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:247,columnNumber:1},this),`\n`,(0,n.jsxDEV)(e.p,{children:\"To ensure consistent comparisons, every randomized aspect of the Flax model is assigned a coherent seed. However, attempts to make TensorFlow model loss coherent by seeding the data generator did not yield consistent results. This indicates internal TensorFlow parameters not being consistently initialized, resulting in varying loss compared to Flax models. As a result of this, while the speed up produced by my work is backed up by the graph produced, further work is needed to investigate the state of the Tensorflow model.\"},void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:249,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\",lineNumber:1,columnNumber:1},this)}function Nn(m={}){let{wrapper:e}=m.components||{};return e?(0,n.jsxDEV)(e,Object.assign({},m,{children:(0,n.jsxDEV)(Ue,m,void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this)}),void 0,!1,{fileName:\"/Users/khanhgn/Development/personal-website/posts/_mdx_bundler_entry_point-29456297-a670-49b8-a9d4-e4c2dbd32f81.mdx\"},this):Ue(m)}var xn=Nn;return fn(yn);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
  },
  "_id": "Maptek internship experience report.mdx",
  "_raw": {
    "sourceFilePath": "Maptek internship experience report.mdx",
    "sourceFileName": "Maptek internship experience report.mdx",
    "sourceFileDir": ".",
    "contentType": "mdx",
    "flattenedPath": "Maptek internship experience report"
  },
  "type": "Post",
  "url": "/posts/Maptek internship experience report"
}